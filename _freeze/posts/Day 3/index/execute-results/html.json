{
  "hash": "e04905845075a43b2e869456272296c0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 3: Counts\"\nauthor: \"Vasantha M\"\nformat: html\neditor: visual\n---\n\n\n\n## Introduction:\n\nToday we as a class explored [Counts](https://av-quarto.netlify.app/content/courses/analytics/descriptive/modules/20-barplots/) using a data set, taxi, about taxi rides taken in Chicago in 2022. Under the 'Your Turn' section of the [Counts](https://av-quarto.netlify.app/content/courses/analytics/descriptive/modules/20-barplots/) page, I chose to investigate the fertility data set.\n\n> ### Overview\n>\n> -   First install packages and call them to the document\n>\n> -   Then call the data set and perform glimpse(), inspect() and skim()\n>\n> -   If there is anything to be munged, the data is re-organised\n>\n> -   Looking at the data, questions are developed that can be answered by comparing variables\n>\n> -   Then, plot graphs, compare and analyze them\n>\n> -   Lastly revisit the entire process with a new dataset!\n\n.\n\n.\n\n### Setup Chunk:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n:::\n\n\n\n.\n\n.\n\n## Reading Data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi <- read_csv(\"https://vincentarelbundock.github.io/Rdatasets/csv/modeldata/taxi.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 10000 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): tip, company, local, dow, month\ndbl (3): rownames, distance, hour\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ntaxi\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10,000 × 8\n   rownames tip   distance company                      local dow   month  hour\n      <dbl> <chr>    <dbl> <chr>                        <chr> <chr> <chr> <dbl>\n 1        1 yes      17.2  Chicago Independents         no    Thu   Feb      16\n 2        2 yes       0.88 City Service                 yes   Thu   Mar       8\n 3        3 yes      18.1  other                        no    Mon   Feb      18\n 4        4 yes      20.7  Chicago Independents         no    Mon   Apr       8\n 5        5 yes      12.2  Chicago Independents         no    Sun   Mar      21\n 6        6 yes       0.94 Sun Taxi                     yes   Sat   Apr      23\n 7        7 yes      17.5  Flash Cab                    no    Fri   Mar      12\n 8        8 yes      17.7  other                        no    Sun   Jan       6\n 9        9 yes       1.85 Taxicab Insurance Agency Llc no    Fri   Apr      12\n10       10 yes       1.47 City Service                 no    Tue   Mar      14\n# ℹ 9,990 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10,000\nColumns: 8\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ tip      <chr> \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\"…\n$ distance <dbl> 17.19, 0.88, 18.11, 20.70, 12.23, 0.94, 17.47, 17.67, 1.85, 1…\n$ company  <chr> \"Chicago Independents\", \"City Service\", \"other\", \"Chicago Ind…\n$ local    <chr> \"no\", \"yes\", \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\",…\n$ dow      <chr> \"Thu\", \"Thu\", \"Mon\", \"Mon\", \"Sun\", \"Sat\", \"Fri\", \"Sun\", \"Fri\"…\n$ month    <chr> \"Feb\", \"Mar\", \"Feb\", \"Apr\", \"Mar\", \"Apr\", \"Mar\", \"Jan\", \"Apr\"…\n$ hour     <dbl> 16, 8, 18, 8, 21, 23, 12, 6, 12, 14, 18, 11, 12, 19, 17, 13, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n##TABLE!!\ntaxi %>%\n  head(20) %>%\n  kbl(\n   \n    col.names = c(\n      \"SN\", \"Tip\", \"Distance\",\n      \"Company\", \"Local\", \"DOW\",\n      \"Month\", \"Hour\"\n    ),\n    caption = \"Taxi Dataset\"\n  )%>%\n  kable_styling(\n    bootstrap_options = c(\n      \"striped\", \"hover\",\n      \"condensed\", \"responsive\"\n    ),\n    full_width = F, position = \"center\"\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Taxi Dataset</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> SN </th>\n   <th style=\"text-align:left;\"> Tip </th>\n   <th style=\"text-align:right;\"> Distance </th>\n   <th style=\"text-align:left;\"> Company </th>\n   <th style=\"text-align:left;\"> Local </th>\n   <th style=\"text-align:left;\"> DOW </th>\n   <th style=\"text-align:left;\"> Month </th>\n   <th style=\"text-align:right;\"> Hour </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 17.19 </td>\n   <td style=\"text-align:left;\"> Chicago Independents </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Thu </td>\n   <td style=\"text-align:left;\"> Feb </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:left;\"> City Service </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Thu </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 18.11 </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Mon </td>\n   <td style=\"text-align:left;\"> Feb </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 20.70 </td>\n   <td style=\"text-align:left;\"> Chicago Independents </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Mon </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 12.23 </td>\n   <td style=\"text-align:left;\"> Chicago Independents </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Sun </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:left;\"> Sun Taxi </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Sat </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 17.47 </td>\n   <td style=\"text-align:left;\"> Flash Cab </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Fri </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 17.67 </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Sun </td>\n   <td style=\"text-align:left;\"> Jan </td>\n   <td style=\"text-align:right;\"> 6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.85 </td>\n   <td style=\"text-align:left;\"> Taxicab Insurance Agency Llc </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Fri </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.47 </td>\n   <td style=\"text-align:left;\"> City Service </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Tue </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 0.53 </td>\n   <td style=\"text-align:left;\"> Sun Taxi </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Tue </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 6.65 </td>\n   <td style=\"text-align:left;\"> Taxicab Insurance Agency Llc </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Sun </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 16.82 </td>\n   <td style=\"text-align:left;\"> Sun Taxi </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Wed </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.21 </td>\n   <td style=\"text-align:left;\"> Sun Taxi </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Thu </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Fri </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Tue </td>\n   <td style=\"text-align:left;\"> Feb </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n   <td style=\"text-align:left;\"> other </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> Fri </td>\n   <td style=\"text-align:left;\"> Mar </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n   <td style=\"text-align:left;\"> Taxi Affiliation Services </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Sun </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:left;\"> Taxi Affiliation Services </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Mon </td>\n   <td style=\"text-align:left;\"> Feb </td>\n   <td style=\"text-align:right;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:right;\"> 1.60 </td>\n   <td style=\"text-align:left;\"> Taxi Affiliation Services </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> Tue </td>\n   <td style=\"text-align:left;\"> Apr </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi %>%inspect()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n     name     class levels     n missing\n1     tip character      2 10000       0\n2 company character      7 10000       0\n3   local character      2 10000       0\n4     dow character      7 10000       0\n5   month character      4 10000       0\n                                   distribution\n1 yes (92.1%), no (7.9%)                       \n2 other (27.1%) ...                            \n3 no (81.2%), yes (18.8%)                      \n4 Thu (19.6%), Wed (17.5%), Tue (16.3%) ...    \n5 Apr (31.8%), Mar (31.4%), Feb (20.4%) ...    \n\nquantitative variables:  \n      name   class min      Q1  median        Q3     max        mean\n1 rownames numeric   1 2500.75 5000.50 7500.2500 10000.0 5000.500000\n2 distance numeric   0    0.94    1.78   15.5625    42.3    6.224144\n3     hour numeric   0   11.00   15.00   18.0000    23.0   14.177300\n           sd     n missing\n1 2886.895680 10000       0\n2    7.381397 10000       0\n3    4.359904 10000       0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi %>% skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |10000      |\n|Number of columns        |8          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |5          |\n|numeric                  |3          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|tip           |         0|             1|   2|   3|     0|        2|          0|\n|company       |         0|             1|   5|  28|     0|        7|          0|\n|local         |         0|             1|   2|   3|     0|        2|          0|\n|dow           |         0|             1|   3|   3|     0|        7|          0|\n|month         |         0|             1|   3|   3|     0|        4|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd| p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|--:|-------:|-------:|-------:|-------:|:-----|\n|rownames      |         0|             1| 5000.50| 2886.90|  1| 2500.75| 5000.50| 7500.25| 10000.0|▇▇▇▇▇ |\n|distance      |         0|             1|    6.22|    7.38|  0|    0.94|    1.78|   15.56|    42.3|▇▁▂▁▁ |\n|hour          |         0|             1|   14.18|    4.36|  0|   11.00|   15.00|   18.00|    23.0|▁▃▅▇▃ |\n\n\n:::\n:::\n\n\n\n.\n\n.\n\n## Munging Data\n\n.\n\n### Converting Qualitative Variables into Factors:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedA <- taxi %>%\n  dplyr::mutate(\n    tip = as_factor(tip),\n    local = as_factor(local),\n    month = as_factor(month),\n    dow = as_factor(dow),\n    company = as_factor(company),\n    hour = as_factor(hour)\n    \n  )\nglimpse(taxi_modifiedA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10,000\nColumns: 8\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ tip      <fct> yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, y…\n$ distance <dbl> 17.19, 0.88, 18.11, 20.70, 12.23, 0.94, 17.47, 17.67, 1.85, 1…\n$ company  <fct> Chicago Independents, City Service, other, Chicago Independen…\n$ local    <fct> no, yes, no, no, no, yes, no, no, no, no, no, no, no, yes, no…\n$ dow      <fct> Thu, Thu, Mon, Mon, Sun, Sat, Fri, Sun, Fri, Tue, Tue, Sun, W…\n$ month    <fct> Feb, Mar, Feb, Apr, Mar, Apr, Mar, Jan, Apr, Mar, Mar, Apr, A…\n$ hour     <fct> 16, 8, 18, 8, 21, 23, 12, 6, 12, 14, 18, 11, 12, 19, 17, 13, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedA %>%inspect()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n     name  class levels     n missing\n1     tip factor      2 10000       0\n2 company factor      7 10000       0\n3   local factor      2 10000       0\n4     dow factor      7 10000       0\n5   month factor      4 10000       0\n6    hour factor     23 10000       0\n                                   distribution\n1 yes (92.1%), no (7.9%)                       \n2 other (27.1%) ...                            \n3 no (81.2%), yes (18.8%)                      \n4 Thu (19.6%), Wed (17.5%), Tue (16.3%) ...    \n5 Apr (31.8%), Mar (31.4%), Feb (20.4%) ...    \n6 17 (9%), 18 (8.5%), 16 (8.1%) ...            \n\nquantitative variables:  \n      name   class min      Q1  median        Q3     max        mean\n1 rownames numeric   1 2500.75 5000.50 7500.2500 10000.0 5000.500000\n2 distance numeric   0    0.94    1.78   15.5625    42.3    6.224144\n           sd     n missing\n1 2886.895680 10000       0\n2    7.381397 10000       0\n```\n\n\n:::\n:::\n\n\n\n### Ordered Factors - Levels and Labels\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Convert `dow`, `local`, and `month` into ordered factors\ntaxi_modifiedB <- taxi_modifiedA %>%\n  mutate(\n    dow = factor(dow,\n      levels = c(\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"),\n      labels = c(\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"),\n      ordered = TRUE\n    ),\n    ##\n    local = factor(local,\n      levels = c(\"yes\", \"no\"),\n      labels = c(\"yes\", \"no\"),\n      ordered = TRUE\n    ),\n    ##\n    month = factor(month,\n      levels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\"),\n      labels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\"),\n      ordered = TRUE\n    )\n  )\ntaxi_modifiedB %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10,000\nColumns: 8\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ tip      <fct> yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, yes, y…\n$ distance <dbl> 17.19, 0.88, 18.11, 20.70, 12.23, 0.94, 17.47, 17.67, 1.85, 1…\n$ company  <fct> Chicago Independents, City Service, other, Chicago Independen…\n$ local    <ord> no, yes, no, no, no, yes, no, no, no, no, no, no, no, yes, no…\n$ dow      <ord> Thu, Thu, Mon, Mon, Sun, Sat, Fri, Sun, Fri, Tue, Tue, Sun, W…\n$ month    <ord> Feb, Mar, Feb, Apr, Mar, Apr, Mar, Jan, Apr, Mar, Mar, Apr, A…\n$ hour     <fct> 16, 8, 18, 8, 21, 23, 12, 6, 12, 14, 18, 11, 12, 19, 17, 13, …\n```\n\n\n:::\n:::\n\n\n\n> ### Notes\n>\n> -   when ordered isn't set to true, the labels and levels resort to alphabetical as default\n\n.\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>% inspect()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n     name   class levels     n missing\n1     tip  factor      2 10000       0\n2 company  factor      7 10000       0\n3   local ordered      2 10000       0\n4     dow ordered      7 10000       0\n5   month ordered      4 10000       0\n6    hour  factor     23 10000       0\n                                   distribution\n1 yes (92.1%), no (7.9%)                       \n2 other (27.1%) ...                            \n3 no (81.2%), yes (18.8%)                      \n4 Thu (19.6%), Wed (17.5%), Tue (16.3%) ...    \n5 Apr (31.8%), Mar (31.4%), Feb (20.4%) ...    \n6 17 (9%), 18 (8.5%), 16 (8.1%) ...            \n\nquantitative variables:  \n      name   class min      Q1  median        Q3     max        mean\n1 rownames numeric   1 2500.75 5000.50 7500.2500 10000.0 5000.500000\n2 distance numeric   0    0.94    1.78   15.5625    42.3    6.224144\n           sd     n missing\n1 2886.895680 10000       0\n2    7.381397 10000       0\n```\n\n\n:::\n:::\n\n\n\n.\n\n.\n\n## Q1.A: Do more people tip than not?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_bar(~tip, data = taxi_modifiedB) %>%\n  gf_labs(title = \"Plot 1: Counts of Tips\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n.\n\n> ### Notes\n>\n> -   color vs fill\n>\n> -   where are the colours coming from? How can I change them\n>\n> -   position: dodge vs stacked - DEFAULT IS STACKED\n>\n> -   gf_bar - when the y is left blank, it counts\n>\n> -   gf_coloumn - gives the y axis to manually input\n\n.\n\n.\n\n## Q2.A: Does the tip depend upon whether the trip is local or not?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## using colour = ...\ntaxi_modifiedB %>%\n  gf_bar(~local,\n    color = ~tip,\n    position = \"dodge\"\n  ) %>%\n  gf_labs(title = \"Plot 2A.1: Dodged Bar Chart\",\n          subtitle = \"Using Colour\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Using fill = ...\ntaxi_modifiedB %>%\n  gf_bar(~local,\n    fill = ~tip,\n    position = \"dodge\"\n  ) %>%\n  gf_labs(title = \"Plot 2A.2: Dodged Bar Chart\",\n          subtitle = \"Using Fill\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Flipping facets\ntaxi_modifiedB %>%\n  gf_bar(~tip,\n    fill = ~local,\n    position = \"dodge\"\n  ) %>%\n  gf_labs(title = \"Plot 2A.3: Dodged Bar Chart\",\n          subtitle = \"Flipping 'local' and 'tip' variables:\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Using stack\ntaxi_modifiedB %>%\n  gf_bar(~local,\n    fill = ~tip,\n    position = \"stack\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2B.1: Stacked Bar Chart\",\n    subtitle = \"Can we spot per group differences in proportions??\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Flipping Facets\ntaxi_modifiedB %>%\n  gf_bar(~tip,\n    fill = ~local,\n    position = \"stack\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2B.2: Stacked Bar Chart\",\n    subtitle = \"Flipping 'local' and 'tip' variables:\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Using ratio proportions\ntaxi_modifiedB %>%\n  gf_bar(~local,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2C: Filled Bar Chart\",\n    subtitle = \"Comparing using perecentages and ratios\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n.\n\n> ### Understandings from Graphs:\n>\n> -   Plot 2B. 1: People tip more often than not, regardless of if the trip is local or not.\n>\n> -   Plot 2B. 2: Majority of those who tip are going on trips that are not local. This may be true, but its not the *whole truth*.\n>\n>     *BECAUSE PERCENTAGS MATTER - THE NUMBER OF TRIPS THAT ARE LOCAL AND NOT LOCAL ARE NOT THE SAME.*\n>\n> -   Plot 2C: Now we can say for sure that more people tip on trips that are not local.\n\n.\n\n.\n\n## Q3: Do some cab companies get more tips than others?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>%\n  gf_bar(~ company,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 3A: Filled Bar Chart\",\n    subtitle = \"Comparing using perecentages and ratios by company\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n### Re-Ordering the columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedC <- taxi_modifiedB %>% \n  group_by(company) %>%\n  summarise(tipyes_prop = prop(tip), tipno_prop= 1-prop(tip), count_tip = count(tip))%>% arrange(desc(tipyes_prop))\ntaxi_modifiedC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 4\n  company                      tipyes_prop tipno_prop count_tip\n  <fct>                              <dbl>      <dbl>     <int>\n1 Chicago Independents               0.949     0.0512       741\n2 Sun Taxi                           0.939     0.0608      1298\n3 other                              0.928     0.0722      2519\n4 City Service                       0.927     0.0733      1100\n5 Taxicab Insurance Agency Llc       0.925     0.0747      1139\n6 Taxi Affiliation Services          0.906     0.0945      1534\n7 Flash Cab                          0.869     0.131        878\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedC$company <- factor(taxi_modifiedC$company,\n                           levels = taxi_modifiedC$company[order(-taxi_modifiedC$tipyes_prop)])\n  \ntaxi_modifiedC %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 7\nColumns: 4\n$ company     <fct> Chicago Independents, Sun Taxi, other, City Service, Taxic…\n$ tipyes_prop <dbl> 0.9487836, 0.9392185, 0.9278085, 0.9267060, 0.9252640, 0.9…\n$ tipno_prop  <dbl> 0.05121639, 0.06078148, 0.07219153, 0.07329402, 0.07473599…\n$ count_tip   <int> 741, 1298, 2519, 1100, 1139, 1534, 878\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n##a = taxi_modifiedC$tipyes_prop\n##b = taxi_modifiedC$tipno_prop\n##tips = a+b\n##taxi_modifiedD <- taxi_modifiedC %>%\n  ##dplyr::mutate(\n    ##tip = factor(tip,\n                 ##levels = c(\"yes\",\"no\"),\n                 ##labels\n  ##)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedC %>%\n  gf_bar(~ company,\n    fill = ~ tipyes_prop,\n    position = \"fill\"\n  ) %>% \n  gf_labs(\n    title = \"Plot 3A: Filled Bar Chart\",\n    subtitle = \"Comparing using perecentages and ratios by company\"\n  ) %>% \n  \n  gf_theme(theme(\n    axis.text.x = element_text(\n      angle = 45,\n      hjust = 1\n    )\n  ))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> ### Notes\n>\n> -   using arrange(), select() and reorder()\n>\n> -   Don't mix in BaseR when you have tidyverse!!\n>\n> -   How can I bring back the yes and no comparison of tips within each coloumn?\n\n.\n\n## Q4: **Does a tip depend upon the distance, hour of day, and DOW and month?**\n\n.\n\n### Tips by Hour\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>%\n  gf_bar(~ hour,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 4A: [Tips and Hour] Filled Bar Chart\",\n    subtitle = \"..\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n### Tips by DOW\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>%\n  gf_bar(~ dow,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 4B: [Tips and DOW] Filled Bar Chart\",\n    subtitle = \"..\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n### Tips by month\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>%\n  gf_bar(~ month,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 4C: [Tips and Month] Filled Bar Chart\",\n    subtitle = \"..\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n### Tips by DOW and Month\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## With position default\n taxi_modifiedB %>% \n   gf_bar(~ month | dow, \n       fill = ~tip) %>%\n  gf_labs(\n    title = \"Plot E: Counts of Tips by Day of Week and Month\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## With position fill\n taxi_modifiedB %>% \n   gf_bar(~ month | dow, \n       fill = ~tip,\n       position = \"fill\") %>%\n  gf_labs(\n    title = \"Plot E: Counts of Tips by Day of Week and Month\",\n    subtitle = \"According to ratio and proportions\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n### Tips by DOW an Hour\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modifiedB %>% \n  gf_bar(~ hour | dow, \n         fill = ~tip) %>%\n  gf_labs(\n    title = \"Plot G: Counts of Tips by Hour and Day of Week\",\n    \n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n\n```{.r .cell-code}\n## swapping facets would result in a graph that is harder to grasp\n```\n:::\n\n\n\n.\n\n.\n\n## 'Your Turn': Fertility Data Set:\n\n.\n\n### Examining Data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility <- read_csv( file = \"../../Data/Fertility.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 254654 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (6): morekids, gender1, gender2, afam, hispanic, other\ndbl (3): rownames, age, work\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nfertility%>%glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 254,654\nColumns: 9\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ morekids <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ gender1  <chr> \"male\", \"female\", \"male\", \"male\", \"female\", \"male\", \"female\",…\n$ gender2  <chr> \"female\", \"male\", \"female\", \"female\", \"female\", \"female\", \"ma…\n$ age      <dbl> 27, 30, 27, 35, 30, 26, 29, 33, 29, 27, 28, 28, 35, 34, 32, 2…\n$ afam     <chr> \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", …\n$ hispanic <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ other    <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"…\n$ work     <dbl> 0, 30, 0, 0, 22, 40, 0, 52, 0, 0, 0, 52, 52, 52, 8, 7, 0, 40,…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Table\nfertility %>%\n  head(20)%>%\n  kbl(\n   \n    col.names = c(\n      \"SN\", \"More\\n Children\", \"First\\n Child\",\n      \"Second\\n Child\", \"Age\", \"African\\n American\",\"Hispanic\", \"Other\", \"Work\\n in Hours\"\n      \n    ),\n    caption = \"Fertility Dataset\"\n  )%>%\n  kable_styling(\n    bootstrap_options = c(\n      \"striped\", \"hover\",\n      \"condensed\", \"responsive\"\n    ),\n    full_width = F, position = \"center\"\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Fertility Dataset</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> SN </th>\n   <th style=\"text-align:left;\"> More\n Children </th>\n   <th style=\"text-align:left;\"> First\n Child </th>\n   <th style=\"text-align:left;\"> Second\n Child </th>\n   <th style=\"text-align:right;\"> Age </th>\n   <th style=\"text-align:left;\"> African\n American </th>\n   <th style=\"text-align:left;\"> Hispanic </th>\n   <th style=\"text-align:left;\"> Other </th>\n   <th style=\"text-align:right;\"> Work\n in Hours </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility %>% inspect()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n      name     class levels      n missing\n1 morekids character      2 254654       0\n2  gender1 character      2 254654       0\n3  gender2 character      2 254654       0\n4     afam character      2 254654       0\n5 hispanic character      2 254654       0\n6    other character      2 254654       0\n                                   distribution\n1 no (61.9%), yes (38.1%)                      \n2 male (51.4%), female (48.6%)                 \n3 male (51.3%), female (48.7%)                 \n4 no (94.8%), yes (5.2%)                       \n5 no (92.6%), yes (7.4%)                       \n6 no (94.4%), yes (5.6%)                       \n\nquantitative variables:  \n      name   class min       Q1   median       Q3    max         mean\n1 rownames numeric   1 63664.25 127327.5 190990.8 254654 127327.50000\n2      age numeric  21    28.00     31.0     33.0     35     30.39327\n3     work numeric   0     0.00      5.0     44.0     52     19.01833\n            sd      n missing\n1 73512.422063 254654       0\n2     3.386447 254654       0\n3    21.867277 254654       0\n```\n\n\n:::\n:::\n\n\n\n.\n\n.\n\n### Data Dictionary:\n\nI tried finding where the data set originated, but couldn't really trace anything back. From what I could make sense of it, these are my assumptions:\n\n-   There `2,54,654` participants that make up this dataset, with no missing entries.\n\n<!-- -->\n\n-   `morekids`: Those who want more kids, either `yes` or `no`\n\n-   `gender1`: Gender of the first child\n\n-   `gender2`: Gender of the second child\n\n-   `age`: age of the participant in years\n\n-   `afam`: if the participant identifies as African American, either `yes` or `no`\n\n-   `hispanic`: if the participant identifies as Hispanic, either `yes` or `no`\n\n-   `other`: if the participant identifies as another minority, either `yes` or `no`\n\n-   `work:` the number of hours worked in a week\n\n.\n\n.\n\n### Munging Data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modified <- fertility%>%\n  mutate(\n    morekids = as_factor(morekids),\n    gender1 = as_factor(gender1),\n    gender2 = as_factor(gender2),\n    afam = as_factor(afam),\n    hispanic = as_factor(hispanic),\n    other = as_factor(other),\n  )\nglimpse(fertility_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 254,654\nColumns: 9\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ morekids <fct> no, no, no, no, no, no, no, no, no, no, yes, no, no, no, no, …\n$ gender1  <fct> male, female, male, male, female, male, female, male, female,…\n$ gender2  <fct> female, male, female, female, female, female, male, male, mal…\n$ age      <dbl> 27, 30, 27, 35, 30, 26, 29, 33, 29, 27, 28, 28, 35, 34, 32, 2…\n$ afam     <fct> no, no, no, yes, no, no, no, no, no, no, no, no, no, no, no, …\n$ hispanic <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n$ other    <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n$ work     <dbl> 0, 30, 0, 0, 22, 40, 0, 52, 0, 0, 0, 52, 52, 52, 8, 7, 0, 40,…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modified %>%\n  dplyr::mutate(\n    morekids = factor(morekids,\n      levels = c(\"yes\", \"no\"),\n      labels = c(\"Yes\", \"No\"),\n      ordered = TRUE\n    ),\n    ##\n    gender1 = factor(gender1,\n      levels = c(\"male\", \"female\"),\n      labels = c(\"Male\", \"Female\"),\n      ordered = TRUE\n    ),\n    ##\n    gender2 = factor(gender2,\n      levels = c(\"male\", \"female\"),\n      labels = c(\"Male\", \"Female\"),\n      ordered = TRUE\n    ),\n    ##\n    afam = factor(afam,\n      levels = c(\"yes\", \"no\"),\n      labels = c(\"Yes\", \"No\"),\n      ordered = TRUE\n    ),\n     ##\n    hispanic = factor(hispanic,\n      levels = c(\"yes\", \"no\"),\n      labels = c(\"Yes\", \"No\"),\n      ordered = TRUE\n    ),\n     ##\n    other = factor(other,\n      levels = c(\"yes\", \"no\"),\n      labels = c(\"Yes\", \"No\"),\n      ordered = TRUE\n    )\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 254,654 × 9\n   rownames morekids gender1 gender2   age afam  hispanic other  work\n      <dbl> <ord>    <ord>   <ord>   <dbl> <ord> <ord>    <ord> <dbl>\n 1        1 No       Male    Female     27 No    No       No        0\n 2        2 No       Female  Male       30 No    No       No       30\n 3        3 No       Male    Female     27 No    No       No        0\n 4        4 No       Male    Female     35 Yes   No       No        0\n 5        5 No       Female  Female     30 No    No       No       22\n 6        6 No       Male    Female     26 No    No       No       40\n 7        7 No       Female  Male       29 No    No       No        0\n 8        8 No       Male    Male       33 No    No       No       52\n 9        9 No       Female  Male       29 No    No       No        0\n10       10 No       Male    Female     27 No    No       No        0\n# ℹ 254,644 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nfertility_modified %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 254,654\nColumns: 9\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ morekids <fct> no, no, no, no, no, no, no, no, no, no, yes, no, no, no, no, …\n$ gender1  <fct> male, female, male, male, female, male, female, male, female,…\n$ gender2  <fct> female, male, female, female, female, female, male, male, mal…\n$ age      <dbl> 27, 30, 27, 35, 30, 26, 29, 33, 29, 27, 28, 28, 35, 34, 32, 2…\n$ afam     <fct> no, no, no, yes, no, no, no, no, no, no, no, no, no, no, no, …\n$ hispanic <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n$ other    <fct> no, no, no, no, no, no, no, no, no, no, no, no, no, no, no, n…\n$ work     <dbl> 0, 30, 0, 0, 22, 40, 0, 52, 0, 0, 0, 52, 52, 52, 8, 7, 0, 40,…\n```\n\n\n:::\n:::\n\n\n\n.\n\n### Q0: How many participants want more kids?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Count of those who want more kids\nfertility_modified %>% gf_bar(~morekids) %>%\n  gf_labs(title = \"Plot 0.A: Counts of those who want More Kids\",\n          subtitle = \"fill = none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Propotion of those who want more kids\nfertility_modified %>% \n  gf_bar(~morekids,\n         fill = ~morekids,\n          position = \"stack\"           ) %>%\n  gf_labs(title = \"Plot 0.B: Proportion of those who want More Kids\",\n          subtitle = \"position = 'fill'\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> Essentialy I wanted a graph with a single bar, but toggling with 'position' doesn't seem to be doing anything. Why?\n>\n> But moving on:\n\n.\n\n.\n\n### Q1: How does the number of working hours affect the likelihood of wanting more kids?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## trying to use gf_col and make the y axis working hours\nfertility_modified %>%\n  drop_na(work) %>% \n  gf_col(work ~ morekids) %>%\n  gf_labs(title = \"Plot 1.A: Those who want More Kids plotted against Working Hours\",\n          subtitle = \"fill = none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n\n> not really the result I was looking for; why is the y axis in a logarithmic scale??\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## trying with gf_bar and fill instead\nfertility_modified %>% \n  gf_bar(~work,\n         fill = ~morekids,\n         position = \"fill\") %>%\n  gf_labs(title = \"Plot 1.B: Those who want More Kids by Working Hours\",\n          subtitle = \"fill = morekids\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> Now that's more like it!!\n>\n> How would this look like as a line graph?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## work vs morekids line graph\nfertility_modified %>%\n  group_by(work) %>% \n  summarize(morekidsprop = mean(morekids == \"yes\")) %>% \n  gf_line(morekidsprop ~ work)%>%\n  gf_labs(title = \"Plot 1.C:  Proportion of Those who want More Kids by Working Hours\",\n          subtitle = \"line graph\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> -   **Understandings from the Graphs:**\n>\n>     -   Plot 0.A: In general, there are more people who do not wan;t kids.\n>\n>         .\n>\n>     -   Plot 1.B: There seems to be a gradual decline in those who want kids as the work hours per week increase\n>\n>         .\n>\n>     -   Plot 1.C: The line graph indicates that there is indeed a decline overall, though it is not a smooth one. When looking at those who work 50 hours a week, the proportion of those who want kids is definitely less than those who work 0 hours a week - However, the same graph indicates that those who work 25 hours a week have a higher proportion of those who want kids in comparison to those who work 23 hours (a lesser amount).\n>\n> -   Lets plot other variables to see if there are any stronger patterns\n\n.\n\n.\n\n### Q2: Does age affect the likelihood of wanting more kids?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## plotting age vs morekids\nfertility_modified %>% \n  gf_bar(~age,\n         fill = ~morekids,\n         position = \"fill\") %>%\n  gf_labs(title = \"Plot 2: Those who want More Kids by their age\",\n          subtitle = \"fill = morekids\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> Wow, interestingly, the proportion of those who want more kids increases steadily with age.\n\n.\n\n.\n\n### Q3: How do age and work factor into wanting more kids?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## plotting morekids against both age and work\nfertility_modified %>%\n  gf_bar(~ work | age,\n         fill = ~morekids,\n         position = \"fill\") %>%\n  gf_labs(title = \"Plot 3.A: Those who want More Kids by Age and Working Hours\",\n          subtitle = \"fill = morekids\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n\n> The readability is quite low.. what if i filter the ages to look at individually?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## plotting morekids against both age and work - filtered\nfertility_modified %>% \n  filter(age == \"21\")%>%\n  gf_bar(~ work | age,\n         fill = ~morekids,\n         position = \"fill\") %>%\n  gf_labs(title = \"Plot 3.B: Those who are 21 vs More Kids and Working Hours\",\n          subtitle = \"fill = morekids\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> -   **Understandings from the Graphs:**\n>\n>     -   Plot 3.A: Those who are younger seem to have more variation in terms of wanting more kids, that is, it does not seem to be related to their hours of work. Those who are older seem to be of similar opinions across different amounts of work hours, but there is still no established pattern in the relation of the two variables\n>\n>         .\n>\n>     -   Plot 3.B: The missing bars indicate that there is no data at that intersection, i.e, there is nobody in this data set who is 21 years old and works 21 hours a week, and so on.\n\n.\n\n.\n\n### Q4: Do the gender of the existing children play a part in wanting more kids?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## plotting distribution of gender1 and gender 2\nfertility_modified %>% \n  gf_bar(~ gender1 | gender2,\n         fill = ~morekids,\n         position = \"stack\") %>%\n  gf_labs(title = \"Plot 4.A: morekids vs gender\",\n          subtitle = \"fill = morekids\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\n\n> How can this graph be made more readable?\n>\n> Lets try.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modifiedA <- fertility_modified %>%\n  dplyr::mutate(\n    gender = paste( gender1, gender2, sep = \"_\"),\n    gender = factor(gender,\n                    levels = c(\"male_female\", \"male_male\", \"female_male\", \"female_female\", ordered = TRUE ),\n                   labels = c(\"male&female\", \"male&male\",\"male&female\", \"female&female\", ordered = TRUE )))\n \n\nfertility_modifiedA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 254,654 × 10\n   rownames morekids gender1 gender2   age afam  hispanic other  work gender    \n      <dbl> <fct>    <fct>   <fct>   <dbl> <fct> <fct>    <fct> <dbl> <fct>     \n 1        1 no       male    female     27 no    no       no        0 male&fema…\n 2        2 no       female  male       30 no    no       no       30 male&fema…\n 3        3 no       male    female     27 no    no       no        0 male&fema…\n 4        4 no       male    female     35 yes   no       no        0 male&fema…\n 5        5 no       female  female     30 no    no       no       22 female&fe…\n 6        6 no       male    female     26 no    no       no       40 male&fema…\n 7        7 no       female  male       29 no    no       no        0 male&fema…\n 8        8 no       male    male       33 no    no       no       52 male&male \n 9        9 no       female  male       29 no    no       no        0 male&fema…\n10       10 no       male    female     27 no    no       no        0 male&fema…\n# ℹ 254,644 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modifiedA%>% \n  gf_bar(~morekids,\n         fill = ~gender,\n         position = \"dodge\"\n         )%>%\n  gf_labs(title = \"Plot 4.B: morekids vs gender\",\n          subtitle = \"fill = gender\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n\n> Success!\n>\n> Now in looking at proportion:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modifiedA%>% \n  gf_bar(~morekids,\n         fill = ~gender,\n         position = \"fill\"\n         )%>%\n  gf_labs(title = \"Plot 4.C: morekids vs gender\",\n          subtitle = \"fill = gender\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> -   **Understandings from the Graphs:**\n>\n>     -   Plot 4.A: The three combinations of gender are the same relative to each other in both 'yes' and 'no' sections under wanting more kids. in other words, both sections have participants with male and female children as the largest proportion and participants with two female kids making up the smallest proportion\n>\n>         .\n>\n>     -   Plot 4.B: Comparing the proportions, however, can tell us that **those who have two kids of the same gender already are more likely (even if by a small margin) to want more kids.**\n\n.\n\n.\n\n### Q5. What relation (if any) is there between ethnicity and wanting to have more kids?\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modified %>% \n  gf_bar(~morekids,\n         fill = ~afam,\n                              )%>%  \ngf_labs(\n  title = \"Plot 5.A: Counts of those who want More Kids\",\n  subtitle = \"fill = afam\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> Calculating proportions:\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modified %>%\n  ##\n  group_by(morekids) %>% \n  ##\n  summarise(afam_prop = prop(afam), \n            hispanic_prop = prop(hispanic), \n            other_prop = prop(other), \n            majority_prop = sum(prop(afam),prop(hispanic), prop(other))) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  morekids afam_prop hispanic_prop other_prop majority_prop\n  <fct>        <dbl>         <dbl>      <dbl>         <dbl>\n1 no           0.955         0.942      0.951          2.85\n2 yes          0.938         0.900      0.931          2.77\n```\n\n\n:::\n\n```{.r .cell-code}\n  ## the proportions added up become more than 100%??\n```\n:::\n\n\n\n.\n\n> Laying the groundwork, splitting up categories:\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfertility_modifiedB <- fertility_modified %>%\n  group_by(morekids) %>% \n  summarise(\n    afam_prop = mean(afam == \"yes\"),          \n    hispanic_prop = mean(hispanic == \"yes\"),  \n    other_prop = mean(other == \"yes\"),        \n    \n    ## since the proportions were added together and found to be more than one, identifying the overlapping categories\n    \n    afam_hispanic = mean(afam == \"yes\" & hispanic == \"yes\"),\n    afam_other = mean(afam == \"yes\" & other == \"yes\"),\n    hispanic_other = mean(other == \"yes\" & hispanic == \"yes\"),\n    ##\n    \n    only_hispanic = hispanic_prop - sum(hispanic_other, afam_hispanic),\n    \n    only_afam = afam_prop - sum(afam_hispanic, afam_other),\n    \n    only_other = other_prop - sum(afam_other, hispanic_other),\n    \n    majority_prop = mean(afam == \"no\"& hispanic == \"no\"& other == \"no\"),\n    minority_prop = sum(only_hispanic, only_afam, only_other, afam_hispanic, afam_other, hispanic_other))  \n\nglimpse(fertility_modifiedB)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2\nColumns: 12\n$ morekids       <fct> no, yes\n$ afam_prop      <dbl> 0.04520673, 0.06216980\n$ hispanic_prop  <dbl> 0.05824701, 0.10018367\n$ other_prop     <dbl> 0.04884558, 0.06854672\n$ afam_hispanic  <dbl> 0.0006593044, 0.0009493148\n$ afam_other     <dbl> 0, 0\n$ hispanic_other <dbl> 0.02232760, 0.04191431\n$ only_hispanic  <dbl> 0.03526011, 0.05732004\n$ only_afam      <dbl> 0.04454743, 0.06122049\n$ only_other     <dbl> 0.02651799, 0.02663241\n$ majority_prop  <dbl> 0.8706876, 0.8119634\n$ minority_prop  <dbl> 0.1293124, 0.1880366\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Attempting to make my own data set with simply the propotions calculated after summary\nfertilitytwo <- readxl::read_excel(\"../../Data/fertilitytwo.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `` -> `...1`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n```\n\n\n:::\n\n```{.r .cell-code}\nfertilitytwo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 11\n  ...1     ethnicity       ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11\n  <chr>    <chr>           <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n1 morekids afam_prop       hisp… othe… afam… afam… hisp… only… only… only… majo…\n2 no       4.520673000000… 5.82… 4.88… 6.59… 0     2.23… 3.52… 4.45… 2.65… 0.12…\n3 yes      6.216979999999… 0.10… 6.85… 9.49… 0     4.19… 5.73… 6.12… 2.66… 0.18…\n```\n\n\n:::\n\n```{.r .cell-code}\n## Quickly realising that won't work ;-;\n```\n:::\n\n\n\n.\n\n> Identifying the proportion of the minority, where the majority is defined by those who do not identify as Hispanic, African American or Other.\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## majority vs minority\nfertility_modifiedB %>%\n  select(\n    morekids, majority_prop, minority_prop\n  ) %>%\n  pivot_longer(cols = c(majority_prop, minority_prop),\n               cols_vary = \"fastest\",\n               names_to = \"ethnicity\") %>%\n  mutate(\n          ethnicity = factor(ethnicity,\n                              levels = c( \"majority_prop\", \"minority_prop\"))\n               ) %>% \n  gf_col(value ~ morekids,\n         fill = ~ethnicity,\n         position = \"fill\") %>%\n  gf_labs(\n    title = \"Plot 5.B: Ethnicity: majority and minority vs morekids\",\n    subtitle = \"position = fill\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## trying pivot longer \nfertility_modifiedB %>%select(-afam_prop, -hispanic_prop,-other_prop, -majority_prop)%>%\n  pivot_longer(cols = c(only_hispanic, only_afam, only_other, afam_hispanic, hispanic_other),\n               cols_vary = \"fastest\",\n               names_to = \"ethnicity\") %>% \n  mutate(\n                 ethnicity = factor(ethnicity,\n                                    levels = c( \"only_afam\", \"afam_hispanic\", \"only_hispanic\", \"hispanic_other\", \"only_other\", ordered = TRUE ))\n               ) %>% \n  gf_col(value ~ morekids,\n         fill = ~ethnicity,\n         position = \"dodge\") %>%\n  gf_labs(\n    title = \"Plot 5.C: minority ethnicity vs morekids\",\n    subtitle = \"position = dodge\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## PROPORTION\nfertility_modifiedB %>%select(-afam_prop, -hispanic_prop,-other_prop, -majority_prop)%>%\n  pivot_longer(cols = c(only_hispanic, only_afam, only_other, afam_hispanic, hispanic_other),\n               cols_vary = \"fastest\",\n               names_to = \"ethnicity\") %>% mutate(\n                 ethnicity = factor(ethnicity,\n                                    levels = c( \"only_afam\", \"afam_hispanic\", \"only_hispanic\", \"hispanic_other\", \"only_other\", ordered = TRUE ))\n               ) %>%\n   \n  gf_col(value ~ morekids,\n         fill = ~ethnicity,\n         position = \"fill\")%>%\n  gf_labs(\n    title = \"Plot 5.D: minority ethnicity vs morekids\",\n    subtitle = \"position = fill\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-52-1.png){width=672}\n:::\n:::\n\n\n\n.\n\n> -   **Understandings from graphs:**\n>\n>     -   Plot 5.B: Minority ethnicities have a higher proportion of those who want more kids.\n>\n>         .\n>\n>     -   Plot 5.C: There is no strong pattern to be concerned with in this plot, as some categories bleed into one another.\n>\n>         .\n>\n>     -   Plot 5.D: Those who identify as Hispanic make up for most of those in the minority ethnicity category who want to have more kids, even if by a small margin. The 'African American Only' and 'Other Only' categories are ever so slightly smaller than their proportion in the 'no' more kids category.\n\n.\n\n.\n\n## Conclusion:\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}